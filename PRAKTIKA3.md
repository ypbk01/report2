# Задание 13. Шифрование с открытым ключом (схема Диффи-Хеллмана)

### **Задание 13. Схема Диффи-Хеллмана**

**Дано:**  
Функция Диффи-Хеллмана имеет вид:  
\[
5^x \pmod{983}
\]  
где:
- \( P = 983 \) (простое число)
- \( a = 5 \) (первообразный корень по модулю P)
- \( \frac{P-1}{2} = \frac{982}{2} = 491 \) - также простое число

---

#### **Часть 1. Реализация схемы Диффи-Хеллмана**

**Участники:** Алиса и Боб

**Шаг 1. Выбор секретных ключей**
- Алиса выбирает секретный ключ: \( A = 17 \) (случайное число, \( 1 < A < P-1 \))
- Боб выбирает секретный ключ: \( B = 23 \) (случайное число, \( 1 < B < P-1 \))

**Шаг 2. Вычисление открытых ключей**

**Алиса вычисляет:**
\[
\alpha = 5^{17} \pmod{983}
\]
Вычисления:
- \( 5^2 = 25 \pmod{983} \)
- \( 5^4 = 25^2 = 625 \pmod{983} \)
- \( 5^8 = 625^2 = 390625 \pmod{983} = 395 \)
- \( 5^{16} = 395^2 = 156025 \pmod{983} = 158 \)
- \( 5^{17} = 158 \times 5 = 790 \pmod{983} \)

**Открытый ключ Алисы:** \( \alpha = 790 \)

**Боб вычисляет:**
\[
\beta = 5^{23} \pmod{983}
\]
Вычисления:
- \( 5^{16} = 158 \) (из предыдущих вычислений)
- \( 5^4 = 625 \)
- \( 5^2 = 25 \)
- \( 5^{23} = 5^{16} \times 5^4 \times 5^2 \times 5^1 \)
- \( 158 \times 625 = 98750 \pmod{983} = 450 \)
- \( 450 \times 25 = 11250 \pmod{983} = 437 \)
- \( 437 \times 5 = 2185 \pmod{983} = 219 \)

**Открытый ключ Боба:** \( \beta = 219 \)

**Шаг 3. Обмен открытыми ключами**
- Алиса → Бобу: \( \alpha = 790 \)
- Боб → Алисе: \( \beta = 219 \)

**Шаг 4. Вычисление общего секретного ключа**

**Алиса вычисляет:**
\[
key = \beta^A \pmod{983} = 219^{17} \pmod{983}
\]
Вычисления:
- \( 219^2 = 47961 \pmod{983} = 708 \)
- \( 219^4 = 708^2 = 501264 \pmod{983} = 110 \)
- \( 219^8 = 110^2 = 12100 \pmod{983} = 324 \)
- \( 219^{16} = 324^2 = 104976 \pmod{983} = 914 \)
- \( 219^{17} = 914 \times 219 = 200166 \pmod{983} = 456 \)

**Боб вычисляет:**
\[
key = \alpha^B \pmod{983} = 790^{23} \pmod{983}
\]
Вычисления:
- \( 790^2 = 624100 \pmod{983} = 635 \)
- \( 790^4 = 635^2 = 403225 \pmod{983} = 411 \)
- \( 790^8 = 411^2 = 168921 \pmod{983} = 858 \)
- \( 790^{16} = 858^2 = 736164 \pmod{983} = 748 \)
- \( 790^{23} = 790^{16} \times 790^4 \times 790^2 \times 790^1 \)
- \( 748 \times 411 = 307428 \pmod{983} = 312 \)
- \( 312 \times 635 = 198120 \pmod{983} = 201 \)
- \( 201 \times 790 = 158790 \pmod{983} = 456 \)

**Общий секретный ключ:** \( key = 456 \)

---

#### **Схема обмена ключами:**

| Alice | Bob |
|-------|-----|
| Выбирает A = 17 | Выбирает B = 23 |
| Вычисляет α = 5¹⁷ mod 983 = 790 | Вычисляет β = 5²³ mod 983 = 219 |
| Передает α = 790 → | ← Передает β = 219 |
| Вычисляет key = 219¹⁷ mod 983 = 456 | Вычисляет key = 790²³ mod 983 = 456 |

**Результат:** Обе стороны получают одинаковый общий секретный ключ **456**, который может быть использован для симметричного шифрования.
__Алиса__ передаёт Бобу: $\alpha$ = 782
__Боб__ передаёт Алисе: $\beta$ = 619

__4. Вычисление общего секретного ключа:__
__Алиса__ вычисляет:
     $\text{key}$ = $\beta^A$ $\pmod{983}$ = $619^{17}$ $\pmod{983}$
__Боб__ вычисляет:
     $\text{key}$ = $\alpha^B$ $\pmod{983}$ = $782^{23}$ $\pmod{983}$

Оба получают одинаковый ключ: \text{key} = 123
